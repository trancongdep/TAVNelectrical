<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ki·ªÉm Tra Ti·∫øt Di·ªán C√°p (Motor Cable Sizing)</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f7f6; display: flex; justify-content: center; padding: 20px; }
        .container { background-color: #fff; padding: 30px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); width: 100%; max-width: 600px; }
        h2 { text-align: center; color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; }
        
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: 600; color: #34495e; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; font-size: 16px; box-sizing: border-box; }
        
        .row { display: flex; gap: 15px; }
        .col { flex: 1; }

        button { width: 100%; padding: 12px; background-color: #3498db; color: white; border: none; border-radius: 5px; font-size: 18px; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 10px; }
        button:hover { background-color: #2980b9; }

        .result-box { margin-top: 25px; padding: 20px; background-color: #ecf0f1; border-radius: 8px; display: none; }
        .result-item { display: flex; justify-content: space-between; margin-bottom: 10px; border-bottom: 1px dashed #bdc3c7; padding-bottom: 5px; }
        .result-val { font-weight: bold; }
        
        .status { text-align: center; padding: 15px; border-radius: 5px; font-weight: bold; font-size: 1.2em; margin-top: 15px; color: white; }
        .fail { background-color: #e74c3c; box-shadow: 0 0 10px rgba(231, 76, 60, 0.4); } /* ƒê·ªè - Nguy hi·ªÉm */
        .pass { background-color: #27ae60; box-shadow: 0 0 10px rgba(39, 174, 96, 0.4); } /* Xanh - An to√†n */
        .warn { background-color: #f39c12; box-shadow: 0 0 10px rgba(243, 156, 18, 0.4); } /* V√†ng - C·∫£nh b√°o */

        .note { font-size: 0.85em; color: #7f8c8d; font-style: italic; margin-top: 5px; }
    </style>
</head>
<body>

<div class="container">
    <h2>‚ö° Ki·ªÉm Tra C√°p ƒê·ªông C∆°</h2>
    <p class="note">D·ª±a tr√™n ti√™u chu·∫©n TCVN 7447-5-52 & IEC 60364</p>

    <div class="input-group">
        <label>C√¥ng su·∫•t ƒê·ªông c∆° (P) [kW]:</label>
        <input type="number" id="p_kw" value="75" step="0.5">
    </div>

    <div class="row">
        <div class="col input-group">
            <label>ƒêi·ªán √°p (V):</label>
            <input type="number" id="volt" value="380">
        </div>
        <div class="col input-group">
            <label>H·ªá s·ªë cosœÜ:</label>
            <input type="number" id="pf" value="0.85" step="0.01" max="1">
        </div>
        <div class="col input-group">
            <label>Hi·ªáu su·∫•t (Œ∑):</label>
            <input type="number" id="eff" value="0.92" step="0.01" max="1">
        </div>
    </div>

    <div class="input-group">
        <label>Ch·ªçn ti·∫øt di·ªán c√°p d·ª± ki·∫øn (mm¬≤):</label>
        <select id="cable_size">
            <option value="16">16 mm¬≤ (I_max ‚âà 94A)</option>
            <option value="25">25 mm¬≤ (I_max ‚âà 119A)</option>
            <option value="35">35 mm¬≤ (I_max ‚âà 148A)</option>
            <option value="50">50 mm¬≤ (I_max ‚âà 180A)</option>
            <option value="70">70 mm¬≤ (I_max ‚âà 232A)</option>
            <option value="95">95 mm¬≤ (I_max ‚âà 282A)</option>
            <option value="120">120 mm¬≤ (I_max ‚âà 328A)</option>
        </select>
        <p class="note">*D√≤ng ƒë·ªãnh m·ª©c c√°p (I_max) tham kh·∫£o cho c√°p ƒê·ªìng (Cu/XLPE) ƒëi trong kh√¥ng kh√≠ (Tray/Ladder).</p>
    </div>

    <div class="input-group">
        <label>H·ªá s·ªë an to√†n / Hi·ªáu ch·ªânh (K):</label>
        <input type="number" id="k_factor" value="1.0" step="0.1">
        <p class="note">Gi·∫£m K n·∫øu ƒëi ng·∫ßm, ƒëi chung m√°ng nhi·ªÅu c√°p, ho·∫∑c nhi·ªát ƒë·ªô cao (VD: 0.8).</p>
    </div>

    <button onclick="checkCable()">KI·ªÇM TRA NGAY</button>

    <div id="resultBox" class="result-box">
        <div class="result-item">
            <span>D√≤ng t·∫£i t√≠nh to√°n (I_load):</span>
            <span class="result-val" id="res_iload" style="color: blue;">0 A</span>
        </div>
        <div class="result-item">
            <span>Kh·∫£ nƒÉng t·∫£i c·ªßa c√°p (I_cable):</span>
            <span class="result-val" id="res_icable">0 A</span>
        </div>
        <div class="result-item">
            <span>D√≤ng sau hi·ªáu ch·ªânh (I_cable √ó K):</span>
            <span class="result-val" id="res_ireal">0 A</span>
        </div>

        <div id="statusMsg" class="status"></div>
        <p id="recommendation" style="margin-top: 15px; font-weight: bold; color: #333; text-align: center;"></p>
    </div>
</div>

<script>
    // B·∫£ng d√≤ng ƒëi·ªán ƒë·ªãnh m·ª©c tham kh·∫£o cho c√°p Cu/XLPE/PVC (3 phase, Air)
    // S·ªë li·ªáu g·∫ßn ƒë√∫ng theo IEC 60364-5-52
    const cableTable = {
        16: 94,
        25: 119,
        35: 148,  // B√†i to√°n n√≥i kho·∫£ng 130-150A
        50: 180,
        70: 232,
        95: 282,
        120: 328
    };

    function checkCable() {
        // 1. L·∫•y d·ªØ li·ªáu
        const P = parseFloat(document.getElementById('p_kw').value);
        const V = parseFloat(document.getElementById('volt').value);
        const PF = parseFloat(document.getElementById('pf').value);
        const Eff = parseFloat(document.getElementById('eff').value);
        const CableSize = parseInt(document.getElementById('cable_size').value);
        const K = parseFloat(document.getElementById('k_factor').value);

        // 2. T√≠nh to√°n d√≤ng t·∫£i (Formula t·ª´ h√¨nh ·∫£nh)
        // I = P / (sqrt(3) * V * PF * Eff)
        // P input l√† kW -> ƒë·ªïi ra W b·∫±ng * 1000
        const I_load = (P * 1000) / (1.732 * V * PF * Eff);
        
        // 3. L·∫•y d√≤ng ƒë·ªãnh m·ª©c c√°p
        const I_cable_base = cableTable[CableSize];
        const I_cable_real = I_cable_base * K; // √Åp d·ª•ng h·ªá s·ªë hi·ªáu ch·ªânh

        // 4. Hi·ªÉn th·ªã th√¥ng s·ªë
        document.getElementById('resultBox').style.display = 'block';
        document.getElementById('res_iload').innerText = I_load.toFixed(1) + " A";
        document.getElementById('res_icable').innerText = I_cable_base + " A (" + CableSize + "mm¬≤)";
        document.getElementById('res_ireal').innerText = I_cable_real.toFixed(1) + " A";

        // 5. ƒê√°nh gi√° v√† Logic so s√°nh
        const statusDiv = document.getElementById('statusMsg');
        const recommendDiv = document.getElementById('recommendation');

        // Logic ƒë√°nh gi√°
        if (I_cable_real < I_load) {
            // TR∆Ø·ªúNG H·ª¢P FAIL (Gi·ªëng b√†i to√°n 75kW d√πng c√°p 35mm2)
            statusDiv.className = "status fail";
            statusDiv.innerText = "‚ùå KH√îNG ƒê·∫†T (QU√Å T·∫¢I)";
            recommendDiv.innerText = "C·∫£nh b√°o: D√≤ng t·∫£i (" + I_load.toFixed(0) + "A) l·ªõn h∆°n kh·∫£ nƒÉng ch·ªãu t·∫£i c·ªßa c√°p (" + I_cable_real.toFixed(0) + "A). Nguy c∆° ch√°y n·ªï cao!";
            
            // T√¨m c√°p ƒë·ªÅ xu·∫•t
            let suggested = null;
            for (let size in cableTable) {
                if (cableTable[size] * K > I_load * 1.25) { // H·ªá s·ªë d·ª± ph√≤ng 1.25
                    suggested = size;
                    break;
                }
            }
            if (suggested) {
                recommendDiv.innerHTML += "<br>üëâ ƒê·ªÅ xu·∫•t: Thay b·∫±ng c√°p t·ªëi thi·ªÉu <b>" + suggested + " mm¬≤</b>.";
            }

        } else if (I_cable_real < I_load * 1.1) {
            // TR∆Ø·ªúNG H·ª¢P S√ÅT T·∫¢I (Warning)
            statusDiv.className = "status warn";
            statusDiv.innerText = "‚ö†Ô∏è C·∫¢NH B√ÅO (S√ÅT T·∫¢I)";
            recommendDiv.innerText = "C√°p ch·ªãu ƒë∆∞·ª£c nh∆∞ng kh√¥ng c√≥ d·ª± ph√≤ng. D·ªÖ b·ªã n√≥ng n·∫øu ho·∫°t ƒë·ªông li√™n t·ª•c ho·∫∑c m√¥i tr∆∞·ªùng kh·∫Øc nghi·ªát.";
        } else {
            // TR∆Ø·ªúNG H·ª¢P PASS
            statusDiv.className = "status pass";
            statusDiv.innerText = "‚úÖ ƒê·∫†T Y√äU C·∫¶U";
            recommendDiv.innerText = "Ti·∫øt di·ªán c√°p ƒë·∫£m b·∫£o an to√†n v·∫≠n h√†nh.";
        }
    }
</script>

</body>
</html>